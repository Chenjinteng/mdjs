# Mdjs开发手册
> Mdjs是一个轻量级的Js的Markdown文件解析器

---
文档更新时间:`2015年12月04日`
作者:`刘越(hangxingliu)`

[TOC]

## 开源声明

Mdjs遵循[Apache Licence 2.0](LICENSE)

> 允许使用在商业应用中,允许通过修改来满足实际需求(但需要在被修改的文件中说明).

## 核心类

	window.Mdjs

## 版本更新

### `想象` 0.4 Dev 这个版本我应该会更新:

> 1. 脚注
> 2. 参考式链接
> 3. 多个引用区块嵌套

### `想象` 0.3 Dev 这个版本我应该会更新:

> 1. 表格
> 2. 链接内嵌套图片
> 3. 目录的可链接性
> 4. 优化一下输出格式

### 0.2 Dev `2015/12/04`

- 修复了一个区块引用换行的BUG
- 表示粗体斜体使用下划线表示
- 列表支持+号表示
- 支持了Hr横线表示上一行标题,以及Hr横线中可以有空格
- 对图片的展位字符串进行了 HTML转义
- < >表示的自动链接
- 如果\[,\],(,),<,>,!没有语义则可以正常输出

### 0.1 Dev `2015/12/03`
- 首个版本

## 目前支持

> 目前用的最多的最广的的Markdown语法都能被解析

- **标题**(支持右端有\#,允许行内样式,也可以通过下一行表示Hr横线来表达)
- **引用**\(除了第一行引用,紧接着的引用文本可以不用>符号\)
- **目录**\(TOC,生成的目录可以自动去掉标题中的样式\)
- **图片**
- **粗体,斜体**\(行内样式可以叠加,可以使用下划线或星号)
- **超链接**(支持自动链接)
- **有序列表,无序列表**\(支持:`-*数字`\)
- **代码**\(行内代码,\`\`\`代码块,用tab键组成的代码块\)
- **转义字符**(\[,\],(,),<,>在没有语义也可以正常输出)
- **HTML标签**
- **水平分割线**\(---,\*\*\*,\_\_\_,===,中间也可以有空格)

## 暂不支持

1. 表格
2. 链接内嵌套图片,除非使用HTML的方式
3. 脚注
4. 目录可链接性
5. 参考式的链接
6. 多个引用区块嵌套
7. 公式,图表.....(这些没有打算支持)


## 解析原理(源码分析)

> 由于不是专业的前端开发,所以代码的风格可能收到C/Java/PHP...多种语言的影响,请多多见谅
> 我源码中的JSDoc和注释其实写的比较详细

### 我代码内的一些概念

`整行样式` : 比如标题,列表,引用,代码....

`行内样式` :	比如加粗,倾斜,行内代码...

### 主线

1. `Mdjs.md2html`:负责拆解Markdown文本成一行一行
	1. `Mdjs.handlerLines`:负责将一行一行的Markdown语句解析
		1. `Mdjs.handlerList`:负责处理列表行
		2. `Mdjs.handlerListEnd`:负责处理列表的结尾
		3. `Mdjs.handlerTOC`:负责生成目录的HTML
			1. `Mdjs.handlerInline`:负责将一行没有了其他例如标题,引用这些头部标记的Markdown语句\(即解析一些行内样式\)

### 工具

- `Mdjs._inArray` 判断元素在数组内吗?
- `Mdjs._isHr` 一句语句是水平分割线(hr横线)吗?
- `Mdjs._isAList`一句语句是列表吗?
- `Mdjs._leftSpace`一个语句的前面有多少个空格/Tab键
- `Mdjs._htmlSafer`字符串的HTML转义
- `Mdjs._isExpressAOrImage`判断一个语句从一个位置开始后面还有没有](...)的结构,即判断`[`是否有表示链接或图片的结构含义

### 栈

> 我写 0.2 Dev版时才发现原来Javascript的数组元素可以push和pop的....

- 处理列表的时候使用
- 其实在输出TOC目录的时候也用到了一个在函数内的栈结构


## 开发参考资料

> Markdown语法参考:
> [Markdown 语法说明 (简体中文版)](http://www.appinn.com/markdown/)
> 
> 一个我很喜欢的Markdown编辑器(有在线版和离线版的)
> [马克飞象](https://maxiang.io/)